<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Journey - Financial Adventure Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Arial Rounded MT Bold', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 30px;
            padding: 40px;
            max-width: 1100px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-height: 95vh;
            overflow-y: auto;
        }

        h1 {
            color: #667eea;
            text-align: center;
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 3px 3px 0px #ffd700;
        }

        .subtitle {
            text-align: center;
            color: #764ba2;
            font-size: 1.2em;
            margin-bottom: 30px;
        }

        .character-setup {
            background: #f8f9ff;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .avatar-picker {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .avatar-option {
            font-size: 4em;
            cursor: pointer;
            padding: 15px;
            border: 4px solid transparent;
            border-radius: 20px;
            transition: all 0.3s;
        }

        .avatar-option:hover {
            transform: scale(1.1);
            border-color: #667eea;
        }

        .avatar-option.selected {
            border-color: #f5576c;
            background: #fff;
        }

        .name-input {
            padding: 15px;
            font-size: 1.3em;
            border: 3px solid #667eea;
            border-radius: 15px;
            width: 300px;
            max-width: 100%;
            text-align: center;
            margin: 20px 0;
        }

        .start-game-btn {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.5em;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        .player-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 20px;
            padding: 20px;
            color: white;
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .player-avatar {
            font-size: 5em;
            background: white;
            border-radius: 50%;
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .player-info {
            flex: 1;
        }

        .player-name {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .life-stage {
            font-size: 1.3em;
            opacity: 0.95;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 18px;
            border-radius: 15px;
            color: white;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .stat-card.emergency {
            background: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);
        }

        .stat-card.debt {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .stat-card.income {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .stat-label {
            font-size: 0.85em;
            opacity: 0.95;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
        }

        .game-section {
            background: #f8f9ff;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .section-title {
            color: #667eea;
            font-size: 1.5em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .life-event-card {
            background: white;
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .life-event-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .life-event-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .event-title {
            font-size: 1.4em;
            color: #667eea;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .event-cost {
            color: #ef4444;
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .event-description {
            color: #6b7280;
            font-size: 0.95em;
        }

        .investment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .investment-card {
            background: white;
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .investment-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .investment-name {
            font-size: 1.2em;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .investment-return {
            color: #10b981;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .investment-risk {
            color: #f59e0b;
            font-size: 0.9em;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.3);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        button.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        button.danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .action-row {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        input[type="number"] {
            padding: 12px;
            border: 3px solid #667eea;
            border-radius: 10px;
            font-size: 1.1em;
            flex: 1;
            min-width: 150px;
        }

        .portfolio {
            background: white;
            padding: 20px;
            border-radius: 15px;
        }

        .portfolio-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9ff;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .notification {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid #f59e0b;
            font-size: 1.15em;
            color: #1f2937;
            display: none;
            animation: slideIn 0.5s;
        }

        .notification.show {
            display: block;
        }

        .notification.success {
            background: linear-gradient(135deg, #34d399 0%, #10b981 100%);
            border-color: #10b981;
        }

        .notification.warning {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border-color: #f59e0b;
        }

        .notification.danger {
            background: linear-gradient(135deg, #fca5a5 0%, #ef4444 100%);
            border-color: #ef4444;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .progress-container {
            margin-top: 15px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: bold;
            color: #374151;
        }

        .progress-bar {
            background: #e5e7eb;
            height: 25px;
            border-radius: 15px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #10b981 0%, #34d399 100%);
            height: 100%;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }

        .hidden {
            display: none;
        }

        .tip-box {
            background: linear-gradient(135deg, #ddd6fe 0%, #c4b5fd 100%);
            border: 3px solid #8b5cf6;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .tip-title {
            font-size: 1.3em;
            color: #6b21a8;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .tip-content {
            color: #4c1d95;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>üåü Life Journey üåü</h1>
        <div class="subtitle">Your Financial Adventure Starts Now!</div>

        <!-- Character Setup Screen -->
        <div id="setupScreen" class="character-setup">
            <h2 style="color: #667eea; margin-bottom: 20px; font-size: 2em;">Create Your Character</h2>
            <p style="margin-bottom: 20px; font-size: 1.1em;">Choose your avatar and name to begin your journey!</p>
            
            <div class="avatar-picker">
                <div class="avatar-option" data-avatar="üë®" onclick="selectAvatar('üë®')">üë®</div>
                <div class="avatar-option" data-avatar="üë©" onclick="selectAvatar('üë©')">üë©</div>
                <div class="avatar-option" data-avatar="üßë" onclick="selectAvatar('üßë')">üßë</div>
                <div class="avatar-option" data-avatar="üë®‚Äçü¶±" onclick="selectAvatar('üë®‚Äçü¶±')">üë®‚Äçü¶±</div>
                <div class="avatar-option" data-avatar="üë©‚Äçü¶±" onclick="selectAvatar('üë©‚Äçü¶±')">üë©‚Äçü¶±</div>
                <div class="avatar-option" data-avatar="üßë‚Äçü¶∞" onclick="selectAvatar('üßë‚Äçü¶∞')">üßë‚Äçü¶∞</div>
            </div>
            
            <input type="text" class="name-input" id="playerName" placeholder="Enter your name" maxlength="20">
            
            <button class="start-game-btn" onclick="startGame()">Start Your Journey! üöÄ</button>
        </div>

        <!-- Main Game Screen -->
        <div id="gameScreen" class="hidden">
            <!-- Player Card -->
            <div class="player-card">
                <div class="player-avatar" id="avatarDisplay"></div>
                <div class="player-info">
                    <div class="player-name" id="nameDisplay"></div>
                    <div class="life-stage" id="stageDisplay">üéì High School Graduate</div>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 0.9em; opacity: 0.9;">Age</div>
                    <div style="font-size: 2em; font-weight: bold;" id="ageDisplay">18</div>
                </div>
            </div>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">üí∞ Cash</div>
                    <div class="stat-value">$<span id="cash">500</span></div>
                </div>
                <div class="stat-card income">
                    <div class="stat-label">üíµ Monthly Income</div>
                    <div class="stat-value">$<span id="income">0</span></div>
                </div>
                <div class="stat-card emergency">
                    <div class="stat-label">üÜò Emergency Fund</div>
                    <div class="stat-value">$<span id="emergency">0</span></div>
                </div>
                <div class="stat-card debt">
                    <div class="stat-label">üìö Debt</div>
                    <div class="stat-value">$<span id="debt">0</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">üìä Investments</div>
                    <div class="stat-value">$<span id="investments">0</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">üèÜ Net Worth</div>
                    <div class="stat-value">$<span id="networth">500</span></div>
                </div>
            </div>

            <!-- Notification -->
            <div id="notification" class="notification"></div>

            <!-- Life Events Section -->
            <div class="game-section">
                <div class="section-title">üéØ Life Decisions</div>
                <div id="lifeEvents"></div>
            </div>

            <!-- Investment Section -->
            <div class="game-section">
                <div class="section-title">üí∏ Manage Your Money</div>
                
                <div style="margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 10px;">Emergency Fund</h3>
                    <p style="margin-bottom: 10px; color: #6b7280;">Financial experts recommend 3-6 months of expenses!</p>
                    <div class="action-row">
                        <input type="number" id="emergencyAmount" placeholder="Amount" min="0">
                        <button onclick="addToEmergency()">Add to Emergency Fund</button>
                    </div>
                </div>

                <div style="margin-bottom: 20px;" id="debtSection" class="hidden">
                    <h3 style="color: #ef4444; margin-bottom: 10px;">Pay Off Debt</h3>
                    <p style="margin-bottom: 10px; color: #6b7280;">Debt charges <span id="debtInterest">5</span>% interest per month!</p>
                    <div class="action-row">
                        <input type="number" id="debtAmount" placeholder="Amount" min="0">
                        <button class="danger" onclick="payDebt()">Pay Down Debt</button>
                    </div>
                </div>

                <h3 style="color: #667eea; margin: 20px 0 10px 0;">Investments</h3>
                <div class="investment-grid">
                    <div class="investment-card" onclick="selectInvestment('savings')">
                        <div class="investment-name">üè¶ Savings Account</div>
                        <div class="investment-return">+2% per month</div>
                        <div class="investment-risk">Risk: Very Low</div>
                        <div style="font-size: 0.85em; margin-top: 8px; color: #6b7280;">Safe and steady</div>
                    </div>

                    <div class="investment-card" onclick="selectInvestment('super')">
                        <div class="investment-name">üèñÔ∏è Superannuation</div>
                        <div class="investment-return">+6% per month</div>
                        <div class="investment-risk">Risk: Low</div>
                        <div style="font-size: 0.85em; margin-top: 8px; color: #6b7280;">For retirement!</div>
                    </div>

                    <div class="investment-card" onclick="selectInvestment('etf')">
                        <div class="investment-name">üìà Index Fund/ETF</div>
                        <div class="investment-return">+0% to +12% per month</div>
                        <div class="investment-risk">Risk: Medium</div>
                        <div style="font-size: 0.85em; margin-top: 8px; color: #6b7280;">Diversified growth</div>
                    </div>

                    <div class="investment-card" onclick="selectInvestment('stocks')">
                        <div class="investment-name">üöÄ Individual Stocks</div>
                        <div class="investment-return">-10% to +20% per month</div>
                        <div class="investment-risk">Risk: High</div>
                        <div style="font-size: 0.85em; margin-top: 8px; color: #6b7280;">High risk, high reward</div>
                    </div>
                </div>

                <div class="action-row">
                    <input type="number" id="investAmount" placeholder="Amount to invest" min="0">
                    <button onclick="makeInvestment()">Invest</button>
                </div>

                <div class="portfolio" style="margin-top: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">Your Portfolio</h4>
                    <div id="portfolio">
                        <div style="color: #9ca3af; text-align: center; padding: 20px;">
                            Start investing to grow your wealth!
                        </div>
                    </div>
                </div>
            </div>

            <!-- Financial Tips -->
            <div class="tip-box" id="tipBox">
                <div class="tip-title">üí° Financial Tip</div>
                <div class="tip-content" id="tipContent">
                    Start by building an emergency fund before investing. This protects you from unexpected expenses!
                </div>
            </div>

            <!-- Progress to Next Life Stage -->
            <div class="game-section">
                <div class="section-title">‚è≠Ô∏è Progress Your Life</div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Life Progress</span>
                        <span id="progressText">0 / 12 months</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar" style="width: 0%">0%</div>
                    </div>
                </div>
                <button onclick="nextMonth()" style="width: 100%; margin-top: 20px; font-size: 1.3em;" class="success">
                    ‚è≠Ô∏è Next Month
                </button>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            playerName: '',
            avatar: 'üë®',
            age: 18,
            month: 0,
            stage: 0,
            cash: 500,
            income: 0,
            emergency: 0,
            debt: 0,
            debtInterest: 5,
            portfolio: {
                savings: 0,
                super: 0,
                etf: 0,
                stocks: 0
            },
            selectedInvestment: null,
            completedEvents: [],
            hasJob: false
        };

        const lifeStages = [
            {
                name: 'üéì High School Graduate',
                age: 18,
                events: [
                    {
                        id: 'parttime',
                        title: 'üíº Get Part-Time Job',
                        description: 'Work 15 hours/week while studying',
                        cost: 0,
                        income: 800,
                        effect: () => {
                            gameState.income += 800;
                            gameState.hasJob = true;
                            showNotification('üéâ Congrats! You now earn $800/month!', 'success');
                        }
                    },
                    {
                        id: 'uni',
                        title: 'üìö Go to University',
                        description: 'Take out a student loan for $30,000',
                        cost: 0,
                        debt: 30000,
                        effect: () => {
                            gameState.debt += 30000;
                            gameState.stage = 1;
                            gameState.age = 19;
                            gameState.month = 0;
                            showNotification('üéì Welcome to uni! You have $30,000 in student debt at 5% monthly interest.', 'warning');
                            updateLifeStage();
                        }
                    }
                ]
            },
            {
                name: 'üéì University Student',
                age: 19,
                monthsRequired: 36,
                events: [
                    {
                        id: 'emergency_setup',
                        title: 'üÜò Build Emergency Fund',
                        description: 'Save $2,000 for unexpected expenses',
                        requirement: () => gameState.emergency >= 2000,
                        effect: () => {
                            showNotification('üí™ Great job! Your emergency fund will protect you from surprise costs!', 'success');
                        }
                    }
                ]
            },
            {
                name: 'üíº Graduate - Entry Level Job',
                age: 22,
                monthsRequired: 24,
                events: [
                    {
                        id: 'graduate_job',
                        title: 'üíº Get Graduate Job',
                        description: 'Full-time job earning $4,000/month',
                        cost: 0,
                        income: 3200,
                        effect: () => {
                            gameState.income = 4000;
                            showNotification('üéâ Congrats on graduating! You now earn $4,000/month!', 'success');
                        }
                    },
                    {
                        id: 'pay_loan',
                        title: 'üìö Pay Student Loan',
                        description: 'Pay off your student debt completely',
                        requirement: () => gameState.debt === 0,
                        effect: () => {
                            showNotification('üéä DEBT FREE! Amazing work paying off your student loan!', 'success');
                        }
                    }
                ]
            },
            {
                name: 'üè° Young Professional',
                age: 24,
                monthsRequired: 24,
                events: [
                    {
                        id: 'car',
                        title: 'üöó Buy a Car',
                        description: 'Purchase a reliable car',
                        cost: 8000,
                        effect: () => {
                            gameState.cash -= 8000;
                            showNotification('üöó New wheels! This will help with getting around!', 'success');
                        }
                    },
                    {
                        id: 'holiday',
                        title: '‚úàÔ∏è Europe Trip',
                        description: 'Take a 3-week holiday to Europe',
                        cost: 5000,
                        effect: () => {
                            gameState.cash -= 5000;
                            showNotification('‚úàÔ∏è Amazing adventure! Memories that will last forever!', 'success');
                        }
                    }
                ]
            },
            {
                name: 'üíë Planning the Future',
                age: 26,
                monthsRequired: 24,
                events: [
                    {
                        id: 'wedding',
                        title: 'üíç Get Married',
                        description: 'Have your dream wedding',
                        cost: 15000,
                        effect: () => {
                            gameState.cash -= 15000;
                            gameState.income += 2000; // Partner contributes
                            showNotification('üíë Congratulations! Your partner contributes $2,000/month to household income!', 'success');
                        }
                    },
                    {
                        id: 'house_deposit',
                        title: 'üè° Save House Deposit',
                        description: 'Save $50,000 for a house deposit',
                        requirement: () => calculateNetWorth() >= 50000,
                        effect: () => {
                            showNotification('üè° Amazing! You\'re ready to buy a home!', 'success');
                        }
                    }
                ]
            },
            {
                name: 'üéØ Established Career',
                age: 28,
                monthsRequired: 36,
                events: [
                    {
                        id: 'super_check',
                        title: 'üèñÔ∏è Retirement Planning',
                        description: 'Have $20,000 in superannuation',
                        requirement: () => gameState.portfolio.super >= 20000,
                        effect: () => {
                            showNotification('üåü Excellent! You\'re building a strong retirement fund!', 'success');
                        }
                    }
                ]
            }
        ];

        const financialTips = [
            'Start by building an emergency fund before investing. This protects you from unexpected expenses!',
            'Pay off high-interest debt before investing heavily. Debt interest can eat away at your wealth!',
            'Diversification is key! Don\'t put all your money in one type of investment.',
            'Super (superannuation) grows tax-free and is a great way to save for retirement!',
            'Index funds/ETFs are less risky than individual stocks because they\'re diversified.',
            'Try to save at least 20% of your income each month for long-term goals!',
            'Your emergency fund should cover 3-6 months of living expenses.',
            'The earlier you start investing, the more time compound interest has to work its magic!',
        ];

        const investments = {
            savings: { name: 'Savings Account', minReturn: 2, maxReturn: 2, emoji: 'üè¶' },
            super: { name: 'Superannuation', minReturn: 5, maxReturn: 7, emoji: 'üèñÔ∏è' },
            etf: { name: 'Index Fund/ETF', minReturn: 0, maxReturn: 12, emoji: 'üìà' },
            stocks: { name: 'Individual Stocks', minReturn: -10, maxReturn: 20, emoji: 'üöÄ' }
        };

        function selectAvatar(avatar) {
            gameState.avatar = avatar;
            document.querySelectorAll('.avatar-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function startGame() {
            const name = document.getElementById('playerName').value.trim();
            if (!name) {
                alert('Please enter your name!');
                return;
            }
            if (!gameState.avatar) {
                alert('Please select an avatar!');
                return;
            }

            gameState.playerName = name;
            document.getElementById('setupScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            document.getElementById('avatarDisplay').textContent = gameState.avatar;
            document.getElementById('nameDisplay').textContent = name;
            
            updateDisplay();
            showRandomTip();
            renderLifeEvents();
        }

        function updateLifeStage() {
            const stage = lifeStages[gameState.stage];
            document.getElementById('stageDisplay').textContent = stage.name;
            document.getElementById('ageDisplay').textContent = gameState.age;
            renderLifeEvents();
        }

        function renderLifeEvents() {
            const stage = lifeStages[gameState.stage];
            const eventsDiv = document.getElementById('lifeEvents');
            
            if (!stage.events || stage.events.length === 0) {
                eventsDiv.innerHTML = '<p style="color: #9ca3af; text-align: center; padding: 20px;">No new life events available. Keep progressing!</p>';
                return;
            }

            let html = '';
            stage.events.forEach(event => {
                const completed = gameState.completedEvents.includes(event.id);
                const canAfford = !event.cost || gameState.cash >= event.cost;
                const meetsRequirement = !event.requirement || event.requirement();
                const locked = completed || (!canAfford && event.cost) || (!meetsRequirement && event.requirement);

                html += `
                    <div class="life-event-card ${locked ? 'locked' : ''}" onclick="${locked ? '' : `doLifeEvent('${event.id}')`}">
                        <div class="event-title">${event.title} ${completed ? '‚úÖ' : ''}</div>
                        ${event.cost ? `<div class="event-cost">Cost: $${event.cost.toLocaleString()}</div>` : ''}
                        ${event.income ? `<div style="color: #10b981; font-size: 1.1em; font-weight: bold;">Income: +$${event.income}/month</div>` : ''}
                        ${event.debt ? `<div style="color: #ef4444; font-size: 1.1em; font-weight: bold;">Debt: +$${event.debt.toLocaleString()}</div>` : ''}
                        ${event.requirement ? `<div style="color: #f59e0b; font-size: 0.95em; margin-top: 5px;">${meetsRequirement ? '‚úÖ Requirement met!' : '‚è≥ Keep working towards this goal!'}</div>` : ''}
                        <div class="event-description">${event.description}</div>
                    </div>
                `;
            });

            eventsDiv.innerHTML = html;
        }

        function doLifeEvent(eventId) {
            const stage = lifeStages[gameState.stage];
            const event = stage.events.find(e => e.id === eventId);
            
            if (!event) return;
            
            if (event.cost && gameState.cash < event.cost) {
                showNotification('‚ùå Not enough cash for this!', 'danger');
                return;
            }

            if (event.requirement && !event.requirement()) {
                showNotification('‚ùå You haven\'t met the requirements yet!', 'danger');
                return;
            }

            gameState.completedEvents.push(eventId);
            event.effect();
            updateDisplay();
            renderLifeEvents();
        }

        function addToEmergency() {
            const amount = parseInt(document.getElementById('emergencyAmount').value);
            if (!amount || amount <= 0) {
                showNotification('‚ùå Please enter a valid amount!', 'danger');
                return;
            }
            if (amount > gameState.cash) {
                showNotification('‚ùå Not enough cash!', 'danger');
                return;
            }

            gameState.cash -= amount;
            gameState.emergency += amount;
            showNotification(`‚úÖ Added $${amount} to emergency fund!`, 'success');
            document.getElementById('emergencyAmount').value = '';
            updateDisplay();
        }

        function payDebt() {
            const amount = parseInt(document.getElementById('debtAmount').value);
            if (!amount || amount <= 0) {
                showNotification('‚ùå Please enter a valid amount!', 'danger');
                return;
            }
            if (amount > gameState.cash) {
                showNotification('‚ùå Not enough cash!', 'danger');
                return;
            }

            const payment = Math.min(amount, gameState.debt);
            gameState.cash -= payment;
            gameState.debt -= payment;
            showNotification(`‚úÖ Paid $${payment} towards your debt!`, 'success');
            document.getElementById('debtAmount').value = '';
            updateDisplay();
        }

        function selectInvestment(type) {
            gameState.selectedInvestment = type;
        }

        function makeInvestment() {
            const amount = parseInt(document.getElementById('investAmount').value);
            const type = gameState.selectedInvestment;

            if (!type) {
                showNotification('‚ùå Please select an investment type first!', 'danger');
                return;
            }

            if (!amount || amount <= 0) {
                showNotification('‚ùå Please enter a valid amount!', 'danger');
                return;
            }

            if (amount > gameState.cash) {
                showNotification('‚ùå Not enough cash!', 'danger');
                return;
            }

            gameState.cash -= amount;
            gameState.portfolio[type] += amount;
            showNotification(`‚úÖ Invested $${amount} in ${investments[type].name}!`, 'success');
            document.getElementById('investAmount').value = '';
            updateDisplay();
        }

        function nextMonth() {
            gameState.month++;
            
            // Add monthly income
            gameState.cash += gameState.income;
            
            // Apply debt interest
            if (gameState.debt > 0) {
                const interest = Math.round(gameState.debt * (gameState.debtInterest / 100));
                gameState.debt += interest;
            }

            // Calculate investment returns
            let totalReturns = 0;
            let events = [];

            for (let type in gameState.portfolio) {
                if (gameState.portfolio[type] > 0) {
                    const inv = investments[type];
                    const returnRate = Math.random() * (inv.maxReturn - inv.minReturn) + inv.minReturn;
                    const returnAmount = Math.round(gameState.portfolio[type] * (returnRate / 100));
                    gameState.portfolio[type] += returnAmount;
                    totalReturns += returnAmount;
                    
                    const sign = returnAmount >= 0 ? '+' : '';
                    events.push(`${inv.emoji} ${inv.name}: ${sign}$${returnAmount}`);
                }
            }

            // Random life events
            if (Math.random() < 0.3) {
                const randomEvents = [
                    { text: 'üéâ Tax refund!', cash: 400 },
                    { text: 'üéÇ Birthday gift money!', cash: 150 },
                    { text: 'üöó Car maintenance needed', cash: -200 },
                    { text: 'üì± Phone broke, had to repair', cash: -120 },
                    { text: 'üè• Visited dentist', cash: -180 },
                    { text: 'üéÆ Sold old stuff online', cash: 100 }
                ];
                const event = randomEvents[Math.floor(Math.random() * randomEvents.length)];
                
                // Use emergency fund if available for negative events
                if (event.cash < 0 && gameState.emergency > 0) {
                    const useEmergency = Math.min(Math.abs(event.cash), gameState.emergency);
                    gameState.emergency -= useEmergency;
                    gameState.cash += event.cash + useEmergency;
                    events.push(event.text + ` (Used $${useEmergency} from emergency fund!)`);
                } else {
                    gameState.cash += event.cash;
                    events.push(event.text);
                }
            }

            // Build notification message
            let message = `Month ${gameState.month} Complete!\n`;
            if (gameState.income > 0) message += `üíµ Income: +$${gameState.income}\n`;
            if (gameState.debt > 0) {
                const interest = Math.round(gameState.debt * (gameState.debtInterest / 100));
                message += `üìö Debt interest: +$${interest}\n`;
            }
            if (events.length > 0) {
                message += events.join('\n');
            }

            showNotification(message, 'warning');
            
            // Check stage progression
            const stage = lifeStages[gameState.stage];
            if (stage.monthsRequired && gameState.month >= stage.monthsRequired) {
                if (gameState.stage < lifeStages.length - 1) {
                    gameState.stage++;
                    gameState.month = 0;
                    gameState.age++;
                    updateLifeStage();
                    showNotification(`üéä New Life Stage: ${lifeStages[gameState.stage].name}`, 'success');
                }
            }

            updateDisplay();
            showRandomTip();
        }

        function calculateNetWorth() {
            let total = gameState.cash + gameState.emergency;
            for (let type in gameState.portfolio) {
                total += gameState.portfolio[type];
            }
            total -= gameState.debt;
            return total;
        }

        function updateDisplay() {
            document.getElementById('cash').textContent = gameState.cash.toLocaleString();
            document.getElementById('income').textContent = gameState.income.toLocaleString();
            document.getElementById('emergency').textContent = gameState.emergency.toLocaleString();
            document.getElementById('debt').textContent = gameState.debt.toLocaleString();
            
            let investmentTotal = 0;
            for (let type in gameState.portfolio) {
                investmentTotal += gameState.portfolio[type];
            }
            document.getElementById('investments').textContent = investmentTotal.toLocaleString();

            const netWorth = calculateNetWorth();
            document.getElementById('networth').textContent = netWorth.toLocaleString();

            // Show/hide debt section
            if (gameState.debt > 0) {
                document.getElementById('debtSection').classList.remove('hidden');
            } else {
                document.getElementById('debtSection').classList.add('hidden');
            }

            // Update progress bar
            const stage = lifeStages[gameState.stage];
            if (stage.monthsRequired) {
                const progress = (gameState.month / stage.monthsRequired) * 100;
                document.getElementById('progressBar').style.width = Math.min(progress, 100) + '%';
                document.getElementById('progressBar').textContent = Math.round(Math.min(progress, 100)) + '%';
                document.getElementById('progressText').textContent = `${gameState.month} / ${stage.monthsRequired} months`;
            } else {
                document.getElementById('progressBar').style.width = '0%';
                document.getElementById('progressBar').textContent = 'Complete events to progress';
                document.getElementById('progressText').textContent = 'Complete events above';
            }

            // Update portfolio display
            const portfolioDiv = document.getElementById('portfolio');
            let hasInvestments = false;
            let html = '';

            for (let type in gameState.portfolio) {
                if (gameState.portfolio[type] > 0) {
                    hasInvestments = true;
                    const inv = investments[type];
                    html += `
                        <div class="portfolio-item">
                            <span>${inv.emoji} ${inv.name}</span>
                            <span style="font-weight: bold; color: #667eea;">$${gameState.portfolio[type].toLocaleString()}</span>
                        </div>
                    `;
                }
            }

            if (!hasInvestments) {
                portfolioDiv.innerHTML = '<div style="color: #9ca3af; text-align: center; padding: 20px;">Start investing to grow your wealth!</div>';
            } else {
                portfolioDiv.innerHTML = html;
            }
        }

        function showNotification(message, type = 'warning') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }

        function showRandomTip() {
            const tip = financialTips[Math.floor(Math.random() * financialTips.length)];
            document.getElementById('tipContent').textContent = tip;
        }
    </script>
</body>
</html>
